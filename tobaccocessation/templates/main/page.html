{% extends "base.html" %}
{% load render accessible %}

{% block title %}{{section.label}}{% endblock %}

{% block extrahead %}
    {{ block.super }}
    {% for block in section.pageblock_set.all %}
        {% rendercss block %}
    {% endfor %}
{% endblock %}

{% block js %}
{{ block.super }}
    <script type="text/javascript" src="/site_media/js/json2.js"></script>
    <script type="text/javascript" src="/site_media/js/quizblockextra.js"></script>
{% endblock %}

{% block extrajs %}
    {{ block.super }}
    {% for block in section.pageblock_set.all %}
        {% renderjs block %}
    {% endfor %}
{% endblock %}

{% block primarynavtabs %}
{% comment %}
    {% if user.is_authenticated %}
        {% include "new_project_primary_nav.html" %}
    {% endif %}
{% endcomment %}
{% endblock %}


{% block extraprimarynav %}
    {% if user.is_staff %}
    <ul class="nav pull-right">
        <li><a href="{{section.get_edit_url}}">Edit Page</a></li>
        
        {% if needs_submit and is_submitted %}
            <li>
                <form action="." method="post">
                    <input type="hidden" name="action" value="reset" />
                    <input type="submit" value="Reset" class="btn pull-right" />
                </form>
            </li>
        {% endif %}
    </ul>
    {% endif %}
{% endblock %}

{% block content %}
   {% if not accessible %}
      <br />
      This page is not currently accessible. Please complete your current section before moving onto a new section.
   {% else %}
        {% if needs_submit %}
            {% if is_submitted %}
            {% else %}
                <form action="." method="post">
            {% endif %}
        {% endif %}
        
		<h2>{{ section.label }}</h2>
		
        {% for block in section.pageblock_set.all %}
            <div class="pageblock{% if block.css_extra %} {{block.css_extra}}{% endif %}">
                {% render block %}
            </div>
        {% endfor %}
        
        {% if needs_submit %}
            {% if request.user.is_anonymous %}
            {% else %}
                <div class="visualclear"></div>        
                {% if is_submitted %}
                    {% if allow_redo %}
                    <form action="." method="post">
                    <input type="hidden" name="action" value="reset" />
                    <input type="submit" value="try again" class="btn pull-right" />
                    </form>
                    {% endif %}
                {% else %}                    
                    <input type="submit" value="Submit" class="btn btn-primary pull-right" />                
                    </form>
                {% endif %}
            {% endif %}
        {% endif %}
   {% endif %}		
{% endblock %}


{% block contentnav %}
      {% if previous %}
         {% ifequal section.hierarchy.name "main" %}
            {% ifaccessible previous %}
                <a href="{{previous.get_absolute_url}}" id="previous">« {{previous.label}}</a>
            {% else %}
                <div id="prev_disabled"><img align="top" src="/site_media/img/lock.png"/> {{previous.label}}</div>
            {% endifaccessible %}
         {% endifequal %}
      {% endif %}

      {% if next %}
         <!-- added to allow javascript access to the menu links. hack for the js activities enabling/disabling of links -->
         <input type="hidden" id="next_section_slug" name="next_section_slug" value="{{next.slug}}"/>
         {% ifaccessible next %}
            <a href="{{next.get_absolute_url}}" id="next">{{next.label}} »</a>
            <div style="display: none;" id="next_disabled">{{next.label}} <img align="top" src="/site_media/img/lock.png" alt="locked"/></div>
         {% else %}
            <a style="display: none" href="{{next.get_absolute_url}}" id="next">{{next.label}} »</a>
            <div id="next_disabled">{{next.label}} <img align="top" src="/site_media/img/lock.png" alt="locked"/></div>
         {% endifaccessible %}
      {% endif %}

{% endblock %}
