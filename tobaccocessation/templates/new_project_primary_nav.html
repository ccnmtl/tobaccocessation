{% load accessible %}
{% load getroot %}

{% comment %}
Cassandra -- 

* The task is to implement the full content menu in the Bootstrap style.
* Do not worry about "accessibility" for the moment.
* Review the references below before you start.
* View this page in a browser. I've included an example dropdown so you can see what needs to be generated.
* And, I've implemented resources.
* Then, search for "CONTENT NAVIGATION" -- I've setup the basic loop to get you started.

References:
* edit_page.html -- Line 121 -- code to display a pagetree hierarchy
* Bootstrap 2.3.2 documentation: http://getbootstrap.com/2.3.2/components.html#navbar
* Section depth: {{s.depth}}

{% endcomment %}










  
{% block primarynavtabs %}
    <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </a>
     
    <!-- Everything you want hidden at 940px or less, place within here -->
    <div class="nav-collapse collapse">
        {% comment %} Example Dropdown Menu with a Submenu {% endcomment %}
        <ul class="nav">
            <li class="dropdown">
                <a data-toggle="dropdown" class="dropdown-toggle" href="#">Dropdown <b class="caret"></b></a>
                <ul class="dropdown-menu">
                    <li class="dropdown-submenu">
                        <a href="#">More options</a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Second level link</a></li>
                            <li><a href="#">Second level link</a></li>
                            <li><a href="#">Second level link</a></li>
                            <li><a href="#">Second level link</a></li>
                            <li><a href="#">Second level link</a></li>
                        </ul>
                    </li>
                    <li><a href="#">Another action</a></li>
                    <li><a href="#">Something else here</a></li>
                    <li class="divider"></li>
                    <li class="nav-header">Nav header</li>
                    <li><a href="#">Separated link</a></li>
                    <li><a href="#">One more separated link</a></li>
                </ul>
            </li>
        </ul>

        {% comment %}
            CONTENT NAVIGATION -- Navigate descendants
            {% if s.depth == 4 %}
{% endif %}


SORT OF WORKS

        <ul class="nav">
            {% for s in root.get_descendants %}
            {% if s.depth == 2 %}
            <li class="dropdown">
                <a data-toggle="dropdown" class="dropdown-toggle" href="#">{{s.label}}{{s.depth}}<b class="caret"></b></a>
            {% endif %}
                <ul class="dropdown-menu">      
                {% if s.depth == 3 %}
                    <li class="dropdown-submenu">
                        <a href="#">{{s.label}}{{s.depth}}</a>
                         </li>
                {% endif %}
                   
                </ul>
            </li>


          {% endfor %} 

        </ul>        
                {% if s.depth == 3 %}


                        {% if s.depth == 2  %}
                        <li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle" href="#">{{s.label}}{{s.depth}}<b class="caret"></b></a></li>
                        <ul class="dropdown-menu">
                        {% for each in s.get_children %}
                        <li class="dropdown-submenu"><a href="#">{{s.label}}{{s.depth}}</a></li>
                        {% endfor %}
                        </ul>
                        {% endif %}






        {% getroot main as root %}
        <ul class="nav">
            {% for s in root.get_descendants %}
                {% if s.depth == 2 and s.get_children %}
                    <li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle" href="#">{{s.label}}{{s.depth}}<b class="caret"></b></a>
                {% else %}
                {% if s.depth == 2 %}
                    <li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle" href="#">{{s.label}}{{s.depth}}</a>
                {% endif %}{% endif %}
                    </li>
          {% endfor %} 
        </ul> 






        {% endcomment %}        






        {% getroot main as root %}
        <ul class="nav">
            {% for s in root.get_descendants %}
                {% if s.depth == 2 %}
                    <li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle" href="#">{{s.label}}{{s.depth}}<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    {% for n in s.get_children %}
                    <li class="dropdown-submenu"><a href="#">{{n.label}}{{n.depth}}</a>
                    {% endfor %}
                    </li></ul>
                    {% endif %}
                    </li>
          {% endfor %} 
        </ul>        




{% comment %}
<div class="tab-content">
    <div id="content-tree" class="tab-pane {% if section.is_root %}active{% endif%}">
        {% with section.hierarchy as hierarchy %}
        <div style="margin-top: 5px; margin-left: 5px;">
            <h3>{{hierarchy.name}}</h3>             
            <a href="{{root.get_edit_url}}"><b>{{hierarchy.get_root.name}}</b></a>
            <ul>
                 {% for s in hierarchy.get_root.get_descendants %}                 
                      <li class="menu" style="list-style: none; line-height: 150%">
                         <a href="{{s.get_edit_url}}">{{s.label}}{% ifequal s section %} <i class="icon-hand-left"></i>{% endifequal %}</a>
      
                        {% if s.get_children %}
                            <ul>
                        {% else %}{% if s.is_last_child %}
                            {% for lc in s.closing_children %}
                                </ul>
                            {% endfor %}
                        {% endif %}{% endif %}     
                     </li>
                 {% endfor %}
             </ul>
         </div>
         {% endwith %}
    </div>        
{% endcomment %}

        {% comment %}
            RESOURCES - The resources menu is a bit more hard-coded, as it offers
            downloadable resources + navigation to child sections.
        {% endcomment %}        
        {% getroot resources as root %} 
        {% with root.get_children.0 as s %}                   
            <ul class="nav pull-right">
                <li class="dropdown
                    {% if s.slug == module.slug or s.slug == section.slug %}
                    {% endif %}">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">{{s.label}} <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="{{ site.domain }}/main/media/pdf/TobaccoCessation_CourseGuide.pdf">Course Guide</a></li>
                        <li><a href="{{ site.domain }}/main/media/pdf/PharmacotherapyTable.pdf">Pharmacotherapy Guide</a></li>
                        <li><a href="{{ site.domain }}/main/media/pdf/CDM_Excuses_NotQuitting.pdf">Excuses For Not Quiting</a></li>
                        <li><a href="{{ site.domain }}/main/media/pdf/CDM_Examples_Empathy.pdf">Examples of Empathy</a></li>
                        <li><a href="/resources/">Videos</a></li>
                        <li class="divider"></li>
                        <li><a href="/resources/">External Resources</a></li>              
                    </ul>
              </li>
            </ul>
        {% endwith %}
    </div>
{% endblock %}